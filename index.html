<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The HIVE MC Status | ULTIMATE</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Cyberpunk / Glassmorphism Theme */
            --bg-dark: #09090b;
            --bg-card: rgba(24, 24, 27, 0.6);
            --bg-card-hover: rgba(39, 39, 42, 0.8);
            
            --accent-primary: #fbbf24; /* Hive Gold */
            --accent-secondary: #8b5cf6; /* Ender Purple */
            --accent-success: #10b981;
            --accent-danger: #ef4444;
            
            --text-main: #f4f4f5;
            --text-muted: #a1a1aa;
            
            --glass-border: 1px solid rgba(255, 255, 255, 0.08);
            --glow: 0 0 20px rgba(139, 92, 246, 0.15);
        }

        * { box-sizing: border-box; outline: none; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 15% 15%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 85% 85%, rgba(251, 191, 36, 0.08) 0%, transparent 50%);
            color: var(--text-main);
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-y: scroll;
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        .header-section {
            text-align: center;
            margin: 60px 0 40px;
            width: 100%;
            max-width: 600px;
            animation: fadeIn 0.8s ease-out;
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 900;
            margin: 0;
            line-height: 1;
            background: linear-gradient(135deg, #fff 30%, var(--accent-primary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .tagline {
            color: var(--accent-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            letter-spacing: 3px;
            margin-top: 15px;
            text-transform: uppercase;
        }

        /* Ê§úÁ¥¢„Ç®„É™„Ç¢ */
        .search-box {
            position: relative;
            margin-top: 40px;
            display: flex;
            gap: 10px;
            background: rgba(255,255,255,0.03);
            padding: 8px;
            border-radius: 20px;
            border: var(--glass-border);
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        input {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        input::placeholder { color: rgba(255,255,255,0.2); }

        .btn-search {
            background: var(--accent-primary);
            color: #000;
            border: none;
            padding: 0 30px;
            border-radius: 14px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-search:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.4);
        }

        /* „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ */
        #dashboard {
            width: 100%;
            max-width: 1100px;
            display: none; /* ÂàùÊúüÈùûË°®Á§∫ */
            animation: slideUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        /* „Éó„É¨„Ç§„É§„Éº„Ç´„Éº„Éâ */
        .hero-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }
        
        /* Ë£ÖÈ£æ„Éê„Éº */
        .hero-card::after {
            content: '';
            position: absolute;
            bottom: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--accent-secondary), var(--accent-primary));
        }

        .avatar-wrapper {
            position: relative;
            width: 120px; height: 120px;
        }

        .avatar {
            width: 100%; height: 100%;
            border-radius: 24px;
            object-fit: cover;
            border: 2px solid rgba(255,255,255,0.1);
            background: #111;
        }

        .player-info h2 {
            font-size: 2.5rem;
            margin: 0;
            letter-spacing: -1px;
        }

        .meta-tags {
            display: flex;
            gap: 10px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        .tag {
            font-size: 0.75rem;
            padding: 6px 14px;
            border-radius: 100px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .tag-xp { background: rgba(139, 92, 246, 0.2); color: #d8b4fe; border: 1px solid rgba(139, 92, 246, 0.3); }
        .tag-date { background: rgba(255,255,255,0.05); color: var(--text-muted); border: var(--glass-border); }

        /* „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 15px;
            margin-bottom: 20px;
            scrollbar-width: none;
        }
        .tabs::-webkit-scrollbar { display: none; }

        .tab {
            background: transparent;
            color: var(--text-muted);
            border: 1px solid transparent;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            white-space: nowrap;
            font-weight: 600;
            transition: 0.3s;
        }
        .tab:hover { color: #fff; background: rgba(255,255,255,0.05); }
        .tab.active {
            background: rgba(139, 92, 246, 0.1);
            border-color: var(--accent-secondary);
            color: var(--accent-secondary);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.1);
        }

        /* „Ç∞„É™„ÉÉ„Éâ„É¨„Ç§„Ç¢„Ç¶„Éà */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
        }

        .stat-box {
            background: var(--bg-card);
            border: var(--glass-border);
            border-radius: 18px;
            padding: 24px;
            transition: 0.3s;
            position: relative;
        }

        .stat-box:hover {
            transform: translateY(-4px);
            background: var(--bg-card-hover);
            border-color: rgba(255,255,255,0.2);
        }

        .stat-label {
            display: block;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            color: #fff;
        }

        .stat-sub {
            font-size: 0.85rem;
            margin-top: 8px;
            color: var(--text-muted);
            opacity: 0.8;
        }

        /* „Ç´„É©„Éº„Éê„É™„Ç®„Éº„Ç∑„Éß„É≥ */
        .c-gold { color: var(--accent-primary); }
        .c-purp { color: var(--accent-secondary); }
        .c-green { color: var(--accent-success); }
        .c-red { color: var(--accent-danger); }

        /* ÁâπÊÆä„Ç´„Éº„Éâ */
        .stat-box.featured {
            grid-column: span 2;
            background: linear-gradient(160deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.9));
        }

        /* „É≠„Éº„Éá„Ç£„É≥„Ç∞ & „Ç®„É©„Éº */
        .loader {
            display: none;
            width: 50px; height: 50px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 50px auto;
        }
        
        .error-msg {
            display: none;
            color: var(--accent-danger);
            background: rgba(239, 68, 68, 0.1);
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 768px) {
            .hero-card { grid-template-columns: 1fr; text-align: center; justify-items: center; }
            .stat-box.featured { grid-column: span 1; }
            h1 { font-size: 2.5rem; }
            .header-section { margin-top: 30px; }
        }
    </style>
</head>
<body>

    <div class="header-section">
        <h1>HIVE <span>ANALYTICS</span></h1>
        <div class="tagline">UNOFFICIAL STATS TRACKER</div>
        
        <div class="search-box">
            <input type="text" id="username" placeholder="Enter Gamertag (e.g. Steve)" autocomplete="off">
            <button class="btn-search" onclick="fetchStats()">SEARCH</button>
        </div>
        <div id="errorMsg" class="error-msg"></div>
    </div>

    <div class="loader" id="loader"></div>

    <div id="dashboard">
        <div class="hero-card">
            <div class="avatar-wrapper">
                <img id="avatar" src="" class="avatar" alt="User Skin">
            </div>
            <div class="player-info">
                <h2 id="displayName">Username</h2>
                <div class="meta-tags">
                    <span class="tag tag-xp" id="totalXP">Calculating...</span>
                    <span class="tag tag-date" id="firstLogin">First Seen: ---</span>
                </div>
            </div>
            <div style="opacity: 0.5; font-size: 3rem;">üéÆ</div>
        </div>

        <div class="tabs" id="tabsContainer"></div>

        <div class="stats-container" id="statsGrid"></div>
    </div>

    <script>
        // --- Ë®≠ÂÆö: „Ç®„É≥„Éâ„Éù„Ç§„É≥„ÉàÂÆöÁæ© ---
        const GAMES = {
            wars:   { name: "Treasure Wars",  id: "wars" },
            sky:    { name: "SkyWars",        id: "sky" },
            sg:     { name: "Survival Games", id: "sg" },
            dr:     { name: "DeathRun",       id: "dr" },
            hide:   { name: "Hide & Seek",    id: "hide" },
            murder: { name: "Murder Mystery", id: "murder" },
            build:  { name: "Just Build",     id: "build" },
            ground: { name: "Ground Wars",    id: "ground" },
            drop:   { name: "Block Drop",     id: "drop" },
            ctf:    { name: "Capture The Flag", id: "ctf" },
            bridge: { name: "The Bridge",     id: "bridge" },
            party:  { name: "Block Party",    id: "party" }
        };

        // CORSÂõûÈÅøÁî®„Éó„É≠„Ç≠„Ç∑ (ÈñãÁô∫„Éª„Éá„É¢Áî®)
        // Êú¨Áï™Áí∞Â¢É„Åß„ÅØËá™Ë∫´„ÅÆ„Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ„Çµ„Éº„Éê„ÉºÁµåÁî±„ÇíÊé®Â•®
        const PROXY_URL = "https://api.allorigins.win/raw?url=";
        const HIVE_API_BASE = "https://api.playhive.com/v0/game/all";

        let currentData = {};
        let activeGame = 'wars';

        // ÂÖ•ÂäõÊ¨Ñ„ÅßEnter„Ç≠„ÉºÂØæÂøú
        document.getElementById('username').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') fetchStats();
        });

        // --- „Éá„Éº„ÇøÂèñÂæó„É°„Ç§„É≥Èñ¢Êï∞ ---
        async function fetchStats() {
            const input = document.getElementById('username').value.trim();
            if (!input) return;

            const username = encodeURIComponent(input); // „Çπ„Éö„Éº„ÇπÂØæÂøú
            
            // UI„É™„Çª„ÉÉ„Éà
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('errorMsg').style.display = 'none';
            document.getElementById('loader').style.display = 'block';

            try {
                // ‰∏¶Âàó„É™„ÇØ„Ç®„Çπ„Éà‰ΩúÊàê (CORS„Éó„É≠„Ç≠„Ç∑ÁµåÁî±)
                // Promise.allSettled „Çí‰Ωø„ÅÜ„Åì„Å®„Åß„ÄÅ‰∏ÄÈÉ®„ÅÆ„Ç≤„Éº„É†„Éá„Éº„Çø„Åå„Å™„Åè„Å¶„ÇÇÂÖ®‰Ωì„ÇíÂ§±Êïó„Åï„Åõ„Å™„ÅÑ
                const promises = Object.values(GAMES).map(game => 
                    fetch(`${PROXY_URL}${encodeURIComponent(`${HIVE_API_BASE}/${game.id}/${username}`)}`)
                        .then(res => {
                            if (!res.ok) throw new Error(res.status);
                            return res.json();
                        })
                        .then(data => ({ gameId: game.id, data: data, status: 'fulfilled' }))
                        .catch(err => ({ gameId: game.id, error: err, status: 'rejected' }))
                );

                const results = await Promise.allSettled(promises);

                // „Éá„Éº„ÇøÊï¥ÁêÜ
                currentData = {};
                let hasAnyData = false;
                let totalXP = 0;
                let oldestJoin = Infinity;

                results.forEach(res => {
                    if (res.status === 'fulfilled' && res.value.status === 'fulfilled') {
                        const { gameId, data } = res.value;
                        currentData[gameId] = data;
                        hasAnyData = true;

                        // ÂÖ®‰ΩìÁµ±Ë®à„ÅÆË®àÁÆó
                        if (data.xp) totalXP += data.xp;
                        if (data.first_played && data.first_played < oldestJoin) {
                            oldestJoin = data.first_played;
                        }
                    }
                });

                if (!hasAnyData) {
                    throw new Error("„Éó„É¨„Ç§„É§„Éº„ÅåË¶ã„Å§„Åã„Çâ„Å™„ÅÑ„Åã„ÄÅ„Éá„Éº„Çø„ÅåÂÖ¨Èñã„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ");
                }

                // --- ÁîªÈù¢ÊèèÁîª ---
                
                // 1. „Éó„É≠„Éï„Ç£„Éº„É´ÊÉÖÂ†±
                document.getElementById('displayName').textContent = decodeURIComponent(username);
                document.getElementById('totalXP').textContent = `TOTAL XP: ${totalXP.toLocaleString()}`;
                
                if (oldestJoin !== Infinity) {
                    const d = new Date(oldestJoin * 1000);
                    document.getElementById('firstLogin').textContent = `First Seen: ${d.getFullYear()}/${d.getMonth()+1}/${d.getDate()}`;
                } else {
                    document.getElementById('firstLogin').textContent = "First Seen: Unknown";
                }

                // „Ç¢„Éê„Çø„Éº: Áµ±ÂêàÁâà„ÅÆÂèØËÉΩÊÄß„ÅåÈ´ò„ÅÑÂ†¥Âêà(„Çπ„Éö„Éº„ÇπÂê´„ÇÄ„Å™„Å©)„ÅÆËÄÉÊÖÆ
                // ‰ªäÂõû„ÅØÊ±éÁî®ÁöÑ„Å™Geyser„Çπ„Ç≠„É≥API„Çí‰ΩøÁî®
                const cleanName = input.replace(/ /g, '%20');
                document.getElementById('avatar').src = `https://crafthead.net/avatar/${cleanName}`;
                // „Ç®„É©„ÉºÊôÇ„ÅÆ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
                document.getElementById('avatar').onerror = function() {
                    this.src = 'https://playhive.com/static/img/hive-logo.png';
                };

                // 2. „Çø„ÉñÁîüÊàê
                renderTabs();
                
                // 3. ÊúÄÂàù„ÅÆÊúâÂäπ„Å™„Ç≤„Éº„É†„ÇíË°®Á§∫
                const firstGame = Object.keys(currentData)[0] || 'wars';
                switchTab(firstGame);

                // Ë°®Á§∫Âàá„ÇäÊõø„Åà
                document.getElementById('loader').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';

            } catch (err) {
                console.error(err);
                document.getElementById('loader').style.display = 'none';
                const errorDiv = document.getElementById('errorMsg');
                errorDiv.textContent = `ERROR: ${err.message || "„Éá„Éº„ÇøÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ"}`;
                errorDiv.style.display = 'block';
            }
        }

        // --- „Çø„ÉñÁîüÊàê ---
        function renderTabs() {
            const container = document.getElementById('tabsContainer');
            container.innerHTML = '';

            Object.keys(currentData).forEach(key => {
                const btn = document.createElement('button');
                btn.className = 'tab';
                btn.textContent = GAMES[key].name;
                btn.onclick = () => switchTab(key);
                btn.dataset.id = key;
                container.appendChild(btn);
            });
        }

        // --- „Çø„ÉñÂàá„ÇäÊõø„Åà ---
        function switchTab(gameId) {
            activeGame = gameId;
            
            // „Çø„Éñ„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÂåñ
            document.querySelectorAll('.tab').forEach(t => {
                t.classList.toggle('active', t.dataset.id === gameId);
            });

            renderStats(gameId);
        }

        // --- Áµ±Ë®à„Ç´„Éº„ÉâÊèèÁîª ---
        function renderStats(gameId) {
            const container = document.getElementById('statsGrid');
            container.innerHTML = '';
            const data = currentData[gameId];
            if (!data) return;

            // ÂÖ±ÈÄö„Éò„É´„Éë„Éº: „Ç´„Éº„ÉâÁîüÊàê
            const createCard = (label, value, sub = '', type = '') => {
                if (value === undefined || value === null) return;
                
                let colorClass = '';
                if (type === 'win') colorClass = 'c-green';
                if (type === 'kill') colorClass = 'c-red';
                if (type === 'gold') colorClass = 'c-gold';

                const div = document.createElement('div');
                div.className = `stat-box ${type === 'featured' ? 'featured' : ''}`;
                div.innerHTML = `
                    <span class="stat-label">${label}</span>
                    <div class="stat-value ${colorClass}">${value.toLocaleString()}</div>
                    ${sub ? `<div class="stat-sub">${sub}</div>` : ''}
                `;
                container.appendChild(div);
            };

            // Âü∫Êú¨„Éá„Éº„ÇøË®àÁÆó
            const played = data.played || 0;
            const victories = data.victories || 0;
            const kills = data.kills || 0;
            const deaths = data.deaths || 0;
            
            const winRate = played > 0 ? ((victories/played)*100).toFixed(1) + '%' : '0%';
            const kd = deaths > 0 ? (kills/deaths).toFixed(2) : kills;

            // --- „Ç´„Éº„ÉâÈÖçÁΩÆ ---
            createCard("Victories", victories, `Win Rate: ${winRate}`, "featured");
            createCard("Kills", kills, `K/D: ${kd}`, "kill");
            createCard("Games Played", played);
            createCard("Deaths", deaths);
            
            if (data.xp) createCard("Experience", data.xp, null, "gold");
            if (data.prestige) createCard("Prestige", data.prestige, "Âë®Âõû„É¨„Éô„É´", "gold");

            // --- „Ç≤„Éº„É†Âõ∫Êúâ„Éá„Éº„Çø (ÂãïÁöÑË°®Á§∫) ---
            // ÂøÖË¶Å„Å´Âøú„Åò„Å¶ËøΩÂä†ÂèØËÉΩ
            const extraStats = {
                'wars': [
                    ['Final Kills', data.final_kills, 'kill'],
                    ['Treasures', data.treasure_destroyed, 'gold']
                ],
                'sky': [
                    ['Mystery Chests', data.mystery_chests_destroyed],
                    ['Spells Used', data.spells_used]
                ],
                'dr': [
                    ['Checkpoints', data.checkpoints],
                    ['Traps Activated', data.activated_traps]
                ],
                'hide': [
                    ['Hiders Killed', data.hider_kills],
                    ['Seekers Killed', data.seeker_kills]
                ],
                'murder': [
                    ['Murders Killed', data.murderer_eliminations],
                    ['Coins', data.coins_collected]
                ]
            };

            if (extraStats[gameId]) {
                extraStats[gameId].forEach(item => {
                    if (item[1] !== undefined) createCard(item[0], item[1], '', item[2]);
                });
            }
        }
    </script>
</body>
</html>
